# Warstwa VI łącza danych ISO/OSI

w jaki sposob dane z wyzszych wart sa przekazywane do medium transmisyjnego

- zapewnienie wartwom wyzszym dostepu do medium transimisyjnego
- wrapuje dodatkowo w adres MAC
- pakiet z warstwy V staje sie `ramka`
- łączy media transmisyjne z oprogramowaniem sieciowym
- implementowana w sprzecie i oprogramowaniu
- implementacja na **urządzeniach końcowych** - komputery, routery, przełączniki
- wykrywa i koryguje błędy na przesyle (warstwa fizyczna) , w Ethernet naprawia nie koryguje

została podzielona na 2 warstwy `LLC` i `MAC`

# karta sieciowa

- odzwierciedlenie warstwy VI łącza danych
- interfejs miedzy oprogramwaniem sieciowym a medium transmisyjnym

# **LLC** - logical link control

- informuje o protokole warstwy sieci (np. IPv4)
- realizuje sterownik karty sieciowej

# **MAC** - media access control

- okresla zasady dostepu do medium
- wykonuje funkcje adresowania

# Ramka

- nie istnieje uniwersalna kazdy standard sieciowy ma swoją
- generalnie składa sie z:
  ![img1](/lab2/img/img1.webp)

# jak działa przesyłanie ramek?

[wiecej o tym z rysunkiem... (działanie ARP)](../lab5/lab5_arp_protocol.mdx)

![img2](/lab2/img/img2.webp)

1. adres MAC urządzenia docelowego (o ile połączenie wychodzi poza sieć) będzie to adres MAC routera

![img3](/lab2/img/img3.webp)

2. router dokona dekapsulacji
3. odczyta adres docelowy IP z pakietu,
4. porówna ten adres ze swoimi wpisami z tablicy routingu,
5. odnajdzie wpis ze do sieci do której prowadzi serwer prowadzi trasa przez ten drugi router

![img4](/lab2/img/img4.webp)

6. Utworzy nową ramke której adresem zródłowym bedzie MAC interfejsu poprzez który łączy sie z tym drugim routerem, docelowym bedzie adres MAC 2 routera
7. Ramka leci do 2 routera

![img5](/lab2/img/img5.webp)

8. Dokonuje dekapsulacji ramki
9. Odczytuje adres IP stwierdza ze to nie on, tylko jakies inne urządzenie z sieci
10. Enkapsuluje, jako zródłowy MAC daje swój a docelowy MAC serwera
11. Komputer jest urządzeniem do celowym więc sobie to zabiera i dekapsuuje

# Protokół ARP - Adress Resolution Protocol

> mapuje adresy logiczne (IP) na adresy fizyczne (MAC)

- na podstawie adresów MAC nie definujemy odbiorcow danych, to dzieje sie poza nami z uzyciem ARP ktory wchodzi w sklad IPv4
- komputer ma tablice ARP ktora adresowi IP przypisuje adres MAC (cachuje to)
  - w win trzyma to sie 10 min
  ```bash
  arp -a
  ```
- są wpisy statyczne i dynamiczne

## co jesli komputer jak chce przesłać dane, zna jego adres IP ale nie zna MAC?

![img6](/lab2/img/img6.webp)

1. tworzy rozgłoszeniową ramke
   - adres zródłowy MAC daje swój
   - adres docelowy **rozgloszeniowy** MAC (same F) FF-FF-FF-FF-FF-FF

![img7](/lab2/img/img7.webp)

2. kazde urządzenie co odebrało dekapuluje do pakietu i sprawdza czy adress IP był jego

   - jeśli to nie jego to ignoruje
   - jesli jego to tworzy nową ramke i zapisuje w niej swój MAC zródłowy adres i wysyła

3. Pierwszy komputer zna już adres MAC bo przyszedł z ramką

# standard Ethernet

- spotykamy w sieciach LAN, MAN, a nawet WAN
- cały zbiór rozwiązań sieciowych implementowanych w **warstwie łącza danych i fizycznej**
- IEEE - Institute of Electrical and Electronic Engineers sprawuje piecze nad tym, opisali standardy`802.2` (LLC) `802.3` (w. fizyczna, MAC)

![img8](/lab2/img/img8.webp)

- łatwy i tani w implementacji
- prosty , niezawodny
- rozwojowy (łatwa zdolność do przyjmowania nowych technologi)

![img9](/lab2/img/img9.webp)

## standard fast ethernet

- tylko poprzez 2 pary żył miedzianych a nie 4 dostępne
- dla sieci małych, mało aplikacji

## standard gigabit ethernet

- potrzeba przepustowości
- używane 4 żyły (wszystkie)
- nie wszystkie switche oferują możliwość pracy i są drozsze

# HUB - koncentartor

kiedyś stosowano koncentratory (HUB) zamiast przełączników w gwieździe

- koncentrator **wysyła dane do wszystkich** urządzeń podłączonych do niego, a to do którego mialo dojść sobie zabiera inne t ignorują
- dużo kolizji -> **domena kolizyjna**
- przepustowosc byla dzielona na wszytskie urządzenia

# switch - przełącznik

teraz są przełaczniki i on wysyla dane do odpowiedniego urządzenia (jest inteligentny)

- miedzy kompem a switchem jest **peer-peer** (debil:punkt-punkt)
- praktycznie brak kolizji, na domene kolizujna sklada sie port przelacznika i komputer
- zaczął być możliwy full duplex (w 2 strony ciagle)
- korzysta do komunikacji z adresów MAC
- mają MAC tablice: port_urzadzenia:MAC
- jeśli jeszcze nie zna adresu MAC urządzenia docelowego to robi `zalewanie` i wysyła te dane do wszystkich oprócz nadawcy
  - ![img10](/lab2/img/img10.webp)
  - adresat odczyta i wysyła wiadomość do switcha a ten zabiera z niej MAC

# bridge - mostek - switch z 2 dziurami

# Ramka Ethernet

![img11](/lab2/img/img11.webp)

**preambuła i znacznik początku ramki** - służą do poinformowania urządzenia docelowego aby przygotował sie na odbiór ramki

**długość** - wielkość pakietu

**typ** - protokół warstwy wyższej (sieciowej) (np. IPv4)

**dane** - pakiet odebrany z warstwy sieciowej, jak mniejszy jest niż 46 B to wypełnia sie losowym crapem

**kod kontrolny** - wykrywa ewentualne błedy,

- wysyłacz oblicza sumę kontrolną i umieszcza ją w tej ramce,
- odbiorca oblicza sume i porownuje czy sie cos nie zgubilo,
  - jezeli jest ok ramka jest akceptowana
  - jak nie to ramka jest oszkodzona i sie ja odrzuca

64B - najmniejsza masa ramki (bez preambuły i początku ramki)

1518 B - najwieksza masa ramki (bez preambuły i początku ramki),
_dla VLAN 1522 (+4) bo uwzględnia indentyfikator sieci wirtualnej_
